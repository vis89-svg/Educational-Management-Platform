<!doctype html>
<html>
    <head>
        <title>My Profile</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
            rel="stylesheet"
        />
    </head>
    <body class="bg-light">
        <!-- 🔹 Navbar with Logout -->
        <nav class="navbar navbar-light bg-white shadow-sm px-3">
            <span class="navbar-brand mb-0 h4">My Profile</span>
            <a href="{% url 'logout' %}" class="btn btn-outline-danger">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </nav>

        <div class="container mt-4">
            <!-- 🔹 Alerts -->
            {% if messages %} {% for message in messages %}
            <div
                class="alert alert-{{ message.tags }} alert-dismissible fade show"
            >
                {{ message }}
                <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                ></button>
            </div>
            {% endfor %} {% endif %}

            <!-- 🔹 Profile -->
            <div class="card shadow p-4 mb-4">
                <h3 class="mb-4">Profile Details</h3>
                <table class="table table-bordered">
                    <tr>
                        <th>Username</th>
                        <td>{{ user.username }}</td>
                    </tr>
                    <tr>
                        <th>Name</th>
                        <td>{{ user.name }}</td>
                    </tr>
                    <tr>
                        <th>Class</th>
                        <td>{{ user.class_name }}</td>
                    </tr>
                    <tr>
                        <th>Admission Date</th>
                        <td>{{ user.admission_date|date:"Y-m-d" }}</td>
                    </tr>
                    <tr>
                        <th>Age</th>
                        <td>{{ user.age }}</td>
                    </tr>
                    <tr>
                        <th>Email</th>
                        <td>{{ user.email }}</td>
                    </tr>
                </table>
            </div>

            <!-- 🔹 Exams -->
            <div class="card shadow p-4">
                <h3 class="mb-4">Available Exams</h3>
                {% if exams %}
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Duration</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for exam in exams %}
                        <tr>
                            <td>{{ exam.title }}</td>
                            <td>{{ exam.description }}</td>
                            <td>{{ exam.date|date:"Y-m-d" }}</td>
                            <td>{{ exam.duration }}</td>
                            <td>
                                <form
                                    method="post"
                                    action="{% url 'profile' %}"
                                    class="d-inline"
                                >
                                    {% csrf_token %}
                                    <input
                                        type="hidden"
                                        name="exam_id"
                                        value="{{ exam.id }}"
                                    />
                                    <input
                                        type="hidden"
                                        name="accepted"
                                        value="true"
                                    />
                                    <button
                                        type="submit"
                                        class="btn btn-sm btn-success"
                                    >
                                        Accept
                                    </button>
                                </form>
                                <form
                                    method="post"
                                    action="{% url 'profile' %}"
                                    class="d-inline"
                                >
                                    {% csrf_token %}
                                    <input
                                        type="hidden"
                                        name="exam_id"
                                        value="{{ exam.id }}"
                                    />
                                    <input
                                        type="hidden"
                                        name="accepted"
                                        value="false"
                                    />
                                    <button
                                        type="submit"
                                        class="btn btn-sm btn-danger"
                                    >
                                        Reject
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p class="text-muted">No exams available.</p>
                {% endif %}
            </div>

            <!-- 🔹 Attendance -->
            <div class="card shadow p-4 mt-4">
                <h3 class="mb-4">Attendance</h3>

                <!-- Month & Year filter -->
                <form method="get" class="d-flex mb-3">
                    <!-- 🔹 Month Select -->
                    <select
                        name="month"
                        class="form-select me-2"
                        style="max-width: 200px"
                    >
                        <option value="" selected disabled>Select Month</option>
                        <option
                            value="1"
                            {%
                            if
                            month=""
                            ="1"
                            %}selected{%
                            endif
                            %}
                        >
                            January
                        </option>
                        <option
                            value="2"
                            {%
                            if
                            month=""
                            ="2"
                            %}selected{%
                            endif
                            %}
                        >
                            February
                        </option>
                        <option
                            value="3"
                            {%
                            if
                            month=""
                            ="3"
                            %}selected{%
                            endif
                            %}
                        >
                            March
                        </option>
                        <option
                            value="4"
                            {%
                            if
                            month=""
                            ="4"
                            %}selected{%
                            endif
                            %}
                        >
                            April
                        </option>
                        <option
                            value="5"
                            {%
                            if
                            month=""
                            ="5"
                            %}selected{%
                            endif
                            %}
                        >
                            May
                        </option>
                        <option
                            value="6"
                            {%
                            if
                            month=""
                            ="6"
                            %}selected{%
                            endif
                            %}
                        >
                            June
                        </option>
                        <option
                            value="7"
                            {%
                            if
                            month=""
                            ="7"
                            %}selected{%
                            endif
                            %}
                        >
                            July
                        </option>
                        <option
                            value="8"
                            {%
                            if
                            month=""
                            ="8"
                            %}selected{%
                            endif
                            %}
                        >
                            August
                        </option>
                        <option
                            value="9"
                            {%
                            if
                            month=""
                            ="9"
                            %}selected{%
                            endif
                            %}
                        >
                            September
                        </option>
                        <option
                            value="10"
                            {%
                            if
                            month=""
                            ="10"
                            %}selected{%
                            endif
                            %}
                        >
                            October
                        </option>
                        <option
                            value="11"
                            {%
                            if
                            month=""
                            ="11"
                            %}selected{%
                            endif
                            %}
                        >
                            November
                        </option>
                        <option
                            value="12"
                            {%
                            if
                            month=""
                            ="12"
                            %}selected{%
                            endif
                            %}
                        >
                            December
                        </option>
                    </select>

                    <!-- 🔹 Year Select -->

                    <button type="submit" class="btn btn-primary">
                        Filter
                    </button>
                </form>

                {% if month and year %}
                <table class="table table-bordered text-center">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for record in attendance_records %}
                        <tr>
                            <td>{{ record.date|date:"Y-m-d" }}</td>
                            <td>
                                {% if record.status == "present" %} ✅ Present
                                {% else %} ❌ Absent {% endif %}
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="2" class="text-muted">
                                No attendance records for this month.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p class="text-muted text-center">
                    Select a month and year to view attendance.
                </p>
                {% endif %}
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>
#working code
